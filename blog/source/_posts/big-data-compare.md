---
title: 大数据处理平台对比
date: 2021-11-09 12:51:15
tags: [big-data]
categories:
	- 答辩
	- 大数据
---

## 1. 关系型数据库：mysql + postgre
优点：
- 稳定
- 简单
- 结构化数据

缺点：
- 存储成本大（时序数据压缩不佳）
- 维护成本高（人工分库分表）
- 写入吞吐低（磁盘IO + 索引建立）
- 查询性能差（磁盘IO + 索引建立）
- 聚合海量性能差（适合事务，不适合聚合）
- 数据规模支持小
- 难以横向扩展
- postgre，聚合查询，容易出现性能瓶颈

## 2. 非关系型数据库：mongodb

优点
- 查询功能强大
- 表结构灵活可变
- 删改数据方便
- 海量存储

缺点
- 多表查询、复杂事务等高级操作有阻碍
- 非分布式，难以横向扩容：集群配置，绑定分片、副本节点
- 字段搜索需要手动索引：B+ tree，最左优先
- 不适合大数据量查询：比不上ES的倒排索引（亿级）
- 不适合多表和复杂条件查询：创建B+树索引
- 不适合全文检索：字段个数有限制
- 不适合聚合：负责聚合通过MapReduce，速度慢

和es的对比
- mongodb适合需要修改的数据，es适合不需要的
- es查询/全文索引/聚合分析比mongodb强

## 3. druid，德鲁伊
介绍：分布式的，支持实时多维OLAP分析的数据处理系统
优点：
- 适合聚合，快速扫描：列式存储，压缩的位图索引
- 可扩展的分布式系统：自我平衡，易于操作
- 支持数据规模大
- 支持实时或批量查询，秒级查询：列存压缩，位图索引，倒排索引，预聚合
- 基于时间的分区：提高时间数据性能

缺点：
- 支持基础的搜索，不支持全文搜索
- 核心功能rollup，rollup之后丢失明细数据
- 不适合复杂聚合
- 外部依赖多，部署运维麻烦

## 4. clickhouse
完全列式存储计算的分析性数据库，OLAP

优点
- 数据压缩
- 多核并行处理，单机性能到极限
- 适合复杂深度聚合：merge tree
- 写入吞吐量大，ES 5倍以上
- 查询速度快，支持SQL（列式+压缩）
- 支持向量化计算
- 服务器成本低，稳定性更高

缺点：
- 分布式依赖zk，无节点发现能力，需要手动配置（和mongodb一样）
- 列式数据库，不支持全文检索（列式存储）
- 无法动态添加字段
- 日志无法长期保存（下线清理）
- 不支持高并发查询（qps 100，单次查询利用所有资源）

## 5. es：全文索引


### （1）mongodb
- 文档查询性能：倒排索引/KDB-Tree比B+树厉害
- 聚合分析能力：ES提供doc-value，比mongodb行式快
- 分布式（集群分片副本）：ES自动 > mongodb手动
- ES特色功能比mongodb多：kibana，监控等等
- ES适合JAVA开发，RESTFUL API，mongodb基于C++
- ES字段自动索引，mongodb需要手动建立
- 存储：内存，不考虑

### （2）druid
- rollup后druid明细数据会丢失，ES可查询明细数据
- druid适合单类聚合查询，不适合复杂的
- druid外部依赖多，部署运维麻烦（存储使用HDFS)；ES搭建十分简单，外部依赖少
- druid不支持全文检索

### （3）clickhouse
- 建表需要专家参与：索引匹配则效率高，不匹配效率波动大
- 并发能力弱：单次查询利用所有资源
- 不支持全文检索：列式存储
- 不适合通过其键检索单行的点查询，es适合点查询
- 分布式，无节点发现能力，需手动配置（节点，分片，副本）

### （4）hermes
- 读写性能：ES读写性能比Hermes好，因为HDFS的性能比不上本地文件系统
- 服务可用性：节点故障时，分片的服务恢复时间相对较长，包括原节点的WAL恢复，索引的online操作；ES可用性较高，多个副本都是online状态，副本切换
- 侧重点：hermes侧重数据分析，es侧重搜索和聚合
- 运营效益：部门相关系统均选择es/ctsdb，有问题，沟通询问更顺畅方便
- 全本搜索 + kibana

### （5）hbase
- 查询：hbase不支持复杂查询（列式存储）
- 依赖重：hbase无专用查询语言，依赖第三方工具
- Rowkey：hbase依赖Rowkey设计，ES更通用

## 6. hermes
大数据实时分析系统
海量数据实时写入和存储，低延迟查询分析的平台
索引的读写和分布式架构自研，底层存储基于HDFS，集群管理利用ZK

缺点
- 写入搜索性能差一点（访问HDFS，比不上访问本地文件系统）
- 查询写入性能差

优点
- 数据导入可以通过kafka等直接写入/MapReduce
- 计算与存储分离，管理精细化，浪费更少
- 分片数据存储在HDFS，资源更加弹性
- 写入时资源消耗低，可用于索引合并的资源更多，减少小索引的数量，提高查询性能，副本异步同步
- hermes将索引和数据分离存储，降低索引目录刷盘次数和目录个数，提高读写
- hermes适合数据分析，es适合检索
- 适合更大规模的业务

## 7. hbase
基于HDFS的数据库，列式存储，无专用查询语言，NoSql数据库

优点
- 海量数据实时查询
- 极强的横向扩展能力
- 近实时系统，支持实时查询
- 支持更大量的数据

缺点
- 复杂查询难以进行，列式存储
- 依赖多：无专用查询语言，依赖第三方
- 基于RowKey，RowKey设计的好坏决定了HBase使用效果

## 8. hadoop
mapReduce + HDFS，hive和hbase的基础

缺点：数据延迟高（离线批处理） + 查询性能差

## 9. hive
hadoop数据仓库工具，分析查询引擎，用于数据分析

功能：hive将sql翻译成MapReduce，处理和计算HDFS数据
缺点：数据延迟高（离线批处理）
特点：本身不存储也不计算，存储依赖HDFS，计算依赖MapReduce



