---
title: ckv+ & ckv & redis
date: 2021-11-09 20:41:16
tags: [cache]
categories:
	- 答辩
	- 缓存
---
## 1. CKV+

#### （1）多数据结构
string，list，zset等等
#### （2）并发处理
单进程，多线程
一个分片绑定一个CPU，避免加锁
- 网络IO，编解码，分给所有CPU
- 数据执行，分片ID指定的CPU

#### （3）强一致同步
raft协议 + 冷备
#### （4）多协议支持
redis + memcache
#### （5）冷热分离
不支持
#### （6）读写性能
多核，多线程
一个分片一个CPU，避免加锁
CPU对应独立的处理进程
网络IO和编解码，使用所有的CPU
数据执行，使用分片ID指定的CPU
#### （7）限制
key，最大64k
value，最大32M
#### （8）内存使用率
多规格block + 动态分配page

## 2. CKV
#### （1）多数据结构
只支持string
#### （2）并发处理
多进程加锁
#### （3）强一致同步
不支持
其他同步:recover恢复中心
#### （4）多协议支持
memcache
#### （5）冷热分离
热数据系统,CMEM
冷数据系统，SSD
#### （6）读写性能
网络IO与核心流程解耦
多进程
逻辑处理，进程间加锁（毛刺）
#### （7）限制
key，2-10bytes
value，最大10M，最好小于1M
#### （8）内存使用率
和obj_size业务平均记录大小有关
业务记录大小分布越集中，碎片率越低

## 3. Redis
#### （1）多数据结构
string，list，zset等等
#### （2）并发处理
多线程，2020年下推出
网络IO多线程
#### （3）强一致同步
不支持，只有异步复制
#### （4）多协议支持

#### （5）冷热分离
不支持
#### （6）读写性能
非阻塞IO + IO多路复用
单线程 + 队列技术 + hash数据结构
#### （7）限制
value，1GB
#### （8）内存使用率
LRU,TTL,腾出空间
- 过期键删除，释放空间无法充分利用

分布式存储，槽机制
- 缩短key，value长度
- 序列化
- 数据对齐
- 安全重启

固定范围的内存块分配：小，大，巨大
每个范围又被划分成多个小的内存块单位